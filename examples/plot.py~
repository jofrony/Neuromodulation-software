def plot_dopamine_control(obj_loaded_traces,type_cell='dSPN'):
    
    data_dict = obj_loaded_traces.get_traces(neuronType=type_cell)
    
   
    
    control = np.array([*data_dict[0].values()])

    da = np.array([*data_dict[1].values()])
    
    control_m = np.mean(control,axis=0)
    control_std = np.std(control,axis=0)
    
    da_m = np.mean(da,axis=0)
    da_std = np.std(da,axis=0)
    
    
    time = np.arange(0,3000.5,0.5)
    for i in np.arange(1,10,1):
            fig = plt.figure()           
            ax = fig.add_subplot(111)
            ax.plot(time,control[i]*1e3,c='black')
            ax.plot(time,da[i]*1e3,c='red')
            ax.set_ylabel('Membrane potential (mV)')
            ax.set_xlabel('Time(ms)')
            
            ax.spines['right'].set_visible(False)
            ax.spines['top'].set_visible(False)
            ax.yaxis.set_ticks_position('left')
            ax.xaxis.set_ticks_position('bottom')
            ax.plot(np.arange(2500,3000),np.ones_like(np.arange(2500,3000))*-75,c='black')
            ax.text(2500,-74,'500 ms')

            if max(da[i])>0:
                ax.set_ylim([-100,40])
                ax.plot(2500*np.ones_like(np.arange(-60,-40)),np.arange(-60,-40),c='black')
                ax.text(2550,-40,'20 mV')
            else:
                ax.set_ylim([-100,-70])
                ax.plot(2500*np.ones_like(np.arange(-80,-75)),np.arange(-80,-75),c='black')
                ax.text(2550,-78,'5 mV')
            
            fig.savefig('Level4/dopamine-control-traces'+str(i)+type_cell+".svg")
            
    plt.figure(0)
    
    plt.plot(time,control_m,c='black')
    plt.plot(time,da_m,c='red')
    plt.fill_between(time,control_m-control_std,control_m+control_std,alpha=.1,color='black')
    plt.fill_between(time,da_m-da_std,da_m+da_std,alpha=.1,color='red')      
    
    plt.show()
